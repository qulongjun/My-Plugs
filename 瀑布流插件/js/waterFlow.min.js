function flow(c,v,k,u,r,x,d,j,f){var a=$("#"+c);var q=$("#"+v);var t=k;var w=u;var e=t+w;var p=[];var m=[];var h=true;var g=0;var o=x;l();n();for(var s=0;s<iCells;s++){p.push(s*e);m.push(0)}function l(){if(h){h=false;q.show();$.getJSON(o,"page="+g,function(i){$.each(i,function(y,B){var A=$("<img>");A.attr("src",B.preview);A.appendTo(a);var C=t/B.width*B.height;var z=b();A.css({width:t,height:C,left:p[z],top:m[z]});m[z]+=C+10});q.hide();h=true})}}function n(){iCells=Math.floor($(window).innerWidth()/e);if(iCells<d){iCells=d}if(iCells>j){iCells=j}a.css("width",iCells*e-w)}function b(){var y=m[0];var z=0;for(var A=0;A<m.length;A++){if(m[A]<y){y=m[A];z=A}}return z}$(window).on("resize",function(){var y=iCells;n();if(y==iCells){return}m=[];p=[];for(var A=0;A<iCells;A++){m[A]=0;p[A]=e*A}a.find("img").each(function(){var i=b();if(f){$(this).animate({left:p[i],top:m[i]},1000)}else{$(this).css({left:p[i],top:m[i]})}m[i]+=$(this).height()+r});var B=$(window).scrollTop()+$(window).innerHeight();var z=b();if(m[z]+a.offset().top<B){g++;l()}});$(window).scroll(function(){var y=$(window).scrollTop()+$(window).innerHeight();var i=b();if(m[i]+a.offset().top<y){g++;l()}})};